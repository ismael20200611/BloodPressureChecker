<!DOCTYPE html>
<html lang="ku" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>الرئيسية</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" defer></script>
    <script src="../js/script.js" defer></script>
    <style>

    </style>
</head>

<body>
    <!-- Header with Logo -->
    <header>
        <nav>
            <a href="#" class="logo"><img src="../img/logo.PNG" alt="Logo" class="logo" /></a> &nbsp;&nbsp;&nbsp;

            <!-- Hamburger toggle for mobile -->
            <div class="menu-toggle" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <ul id="navLinks">
                <li><a href="ar_index.html" class="active">الرئيسية</a></li>
                <li><a href="ar_product.html">منتج</a></li>
                <li><a href="ar_about.html">عن</a></li>
                <li><a href="ar_contact.html">اتصال</a></li>
                <li class="dropdown">
                    <a href="#" class="dropbtn">اللغه ▼</a>
                    <div class="dropdown-content">
                        <a href="../index.html">الإنجليزية</a>
                        <a href="../Ku/ku_index.html">الكردية</a>
                        <a href="../fr/fr_index.html">فرنسي</a>
                        <a href="../sp/sp_index.html">الأسبانية</a>
                        <a href="../po/po_index.html">البولندية</a>
                        <a href="../it/it_index.html">إيطالي</a>
                        <a href="../ch/ch_index.html">الصينية</a>
                        <a href="../ge/ge_index.html">الألمانية</a>
                    </div>
                </li>
            </ul>

        </nav>
    </header>

    <div class="container">
        <h1>جهاز قياس ضغط الدم</h1>
        <p>تحقق من ضغط دمك واحصل على تعليقات فورية.</p>
        <p>أدخل تفاصيلك أدناه:</p>
        <div class="top-group">
            <input type="text" id="fullName" placeholder="Full Name  - الاسم الكامل " />
            <input type="number" id="age" placeholder="Age - عمر" min="1" />
            <select id="gender">
                <option value="male">ذكر</option>
                <option value="female">أنثى</option>
            </select>

        </div>
        <div class="product-list">
            <div class="product-item1">
                <img src="../img/device.png" alt="Product 1">
            </div>
            <div class="product-item2">
                <div class="input-group">
                    <input type="number" id="systolic" placeholder="Systolic" />
                    <input type="number" id="diastolic" placeholder="Diastolic" />
                    <input type="number" id="pulse" placeholder="❤ Pulse" />
                </div>
            </div>
        </div>


        <div id="dateTimeDisplay">جارٍ تحميل الوقت الحالي...</div>

        <button onclick="checkBP()" class="sound-Jazak">تحقق من ضغط الدم</button>

        <div id="result"></div>

        <!-- Danger buttons hidden by default -->
        <button  class="sound-Jazak" onclick="showHelp()" id="helpButton" class="danger-btn" style="display:none;" >🚨 ماذا تفعل الآن؟</button>
        <!-- Add this div below the buttons -->
        <div id="helpGuide" style="display:none; 
  margin-top: 15px; 
  max-width: 600px; 
  background: #fff3f3; 
  border: 1px solid #e55353; 
  color: #a94442; 
  padding: 15px; 
  border-radius: 8px; 
  text-align: right;">
            <strong>🚨 ماذا تفعل الآن؟</strong>
            <ul>
                <li>ابق هادئًا وساعد الشخص على الجلوس بشكل مريح.</li>
                <li>افتح أي ملابس ضيقة.</li>
                <li>شجع على التنفس البطيء والعميق.</li>
                <li>إذا تم وصفه، قدم دواء ضغط الدم الطارئ.</li>
                <li>لا تعطي الكافيين أو المنبهات.</li>
                <li>ابقهم متيقظين وجالسين بشكل مستقيم.</li>
                <li>اتصل بالشرطة على الرقم 911 وابق معهم حتى وصول المساعدة.</li>
            </ul>
        </div>
        <button onclick="speakGuide()" id="speakButton" class="danger-btn Voice-Guidance" style="display:none;">🔊 إرشادات الصوت</button>

        <button onclick="downloadCSV()" class="sound-Jazak">📥 تنزيل ملف CSV</button>
        <button onclick="window.print()" class="sound-Jazak">🖨️ طباعة النتائج</button>

        <div class="history">
            <h3>📜 آخر 100 تحقق:</h3>
            <ul id="historyList"></ul>
        </div>

        <div class="description">
            <strong>دليل ضغط الدم:</strong> تتفاوت النطاقات الطبيعية حسب العمر والجنس. تحقق بانتظام واستشر طبيبًا إذا كنت خارج النطاق.
        </div>

    </div>
    <!-- Footer -->
    <footer>
        <p>أنشأ بواسطة <a href="https://ismael-software.vercel.app/" target="_blank"> نويزيان </a></p>
        <p>آخر تحديث: يونيو 2025</p>
        &copy; <a class="border-bottom" href="ku_index.html">جهاز قياس ضغط الدم</a>, جميع الحقوق محفوظة.صمم بواسطة<a class="border-bottom" href="https://ismael-software.vercel.app/"> نويزيان </a>
        </p>
    </footer>

    <script>
        // Update the date/time display every second
        function updateDateTime() {
            const now = new Date();
            const options = {
                year: "numeric",
                month: "short",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
                second: "2-digit",
            };
            document.getElementById("dateTimeDisplay").textContent = " " + now.toLocaleString(undefined, options);
        }
        setInterval(updateDateTime, 1000);
        updateDateTime(); // initial call

        function checkBP() {
            const fullName = document.getElementById('fullName').value.trim();
            const sys = parseInt(document.getElementById('systolic').value);
            const dia = parseInt(document.getElementById('diastolic').value);
            const pulse = parseInt(document.getElementById('pulse').value);
            const gender = document.getElementById('gender').value;
            const age = parseInt(document.getElementById('age').value);

            const result = document.getElementById('result');
            const helpBtn = document.getElementById('helpButton');
            const speakBtn = document.getElementById('speakButton');

            // Validate inputs
            if (!fullName || isNaN(sys) || isNaN(dia) || isNaN(pulse) || isNaN(age)) {
                result.textContent = "يرجى ملء جميع الحقول بشكل صحيح.";
                result.className = 'danger';
                helpBtn.style.display = 'none';
                speakBtn.style.display = 'none';
                return;
            }

            // Save the record with current time
            const currentTime = new Date().toLocaleString();
            saveHistory({ fullName, sys, dia, pulse, gender, age, time: currentTime });

            // Determine BP status
            let dangerHigh = sys >= 180 || dia >= 120;
            let dangerLow = sys < 80 || dia < 50;
            let normal = (sys >= 90 && sys <= 130) && (dia >= 60 && dia <= 85);

            if (dangerHigh) {
                result.textContent = "❗ خطر مرتفع للغاية! اتصل بالشرطة على الفور!";
                result.className = 'danger';
                helpBtn.style.display = 'inline-block';
                speakBtn.style.display = 'inline-block';
            } else if (dangerLow) {
                result.textContent = "❗ منخفض بشكل خطير! اطلب المساعدة الطبية.";
                result.className = 'danger';
                helpBtn.style.display = 'inline-block';
                speakBtn.style.display = 'inline-block';
            } else if (!normal) {
                result.textContent = "⚠️ ضغط الدم خارج المعدل الطبيعي قليلاً.";
                result.className = 'danger';
                helpBtn.style.display = 'none';
                speakBtn.style.display = 'none';
            } else {
                result.textContent = "✅ ضغط الدم في النطاق الطبيعي.";
                result.className = 'normal';
                helpBtn.style.display = 'none';
                speakBtn.style.display = 'none';
            }
        }

        // Save to localStorage and keep only last 10
        function saveHistory(entry) {
            let history = JSON.parse(localStorage.getItem("bpHistory")) || [];
            history.unshift(entry);
            history = history.slice(0, 100);
            localStorage.setItem("bpHistory", JSON.stringify(history));
            displayHistory();
        }

        // Display history list
        function displayHistory() {
            const history = JSON.parse(localStorage.getItem("bpHistory")) || [];
            const list = document.getElementById("historyList");
            list.innerHTML = '';
            history.forEach((entry, i) => {
                const li = document.createElement("li");
                li.textContent = `${i + 1}. ${entry.fullName} → Sys: ${entry.sys}, Dia: ${entry.dia}, Pulse: ${entry.pulse} @ ${entry.time}`;
                list.appendChild(li);
            });
        }

        // Download history as CSV file
        function downloadCSV() {
            const history = JSON.parse(localStorage.getItem("bpHistory")) || [];
            if (history.length === 0) return alert("No data to download.");
            const header = ["Full Name", "Systolic", "Diastolic", "Pulse", "Gender", "Age", "Time"];
            const rows = history.map(e => [e.fullName, e.sys, e.dia, e.pulse, e.gender, e.age, e.time]);
            const csv = [header, ...rows].map(row => row.join(",")).join("\n");
            const blob = new Blob([csv], { type: "text/csv" });
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "bp_readings.csv";
            a.click();
        }

        // Alert with medical help instructions
        function showHelp() {
            const guideDiv = document.getElementById("helpGuide");
            // Toggle visibility
            if (guideDiv.style.display === "none") {
                guideDiv.style.display = "block";
            } else {
                guideDiv.style.display = "none";
            }
        }

        // Voice guidance with speech synthesis
        function speakGuide() {
            const speakBtn = document.getElementById("speakButton");
            if (window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
                speakBtn.disabled = false;
                return;
            }
            speakBtn.disabled = true;

            const guide = [

                // "إذا كان ضغط الدم مرتفعًا جدًا، اتصل بالشرطة على الرقم 911.",
                // "إذا كان ضغط الدم منخفضًا جدًا، اتصل بطبيبك.",
                // "ابق هادئًا وساعد الشخص على الجلوس بشكل مريح.",
                // "افتح أي ملابس ضيقة.",
                // "شجع على التنفس البطيء والعميق.",
                // "إذا تم وصفه، قدم دواء ضغط الدم الطارئ.",
                // "لا تعطي الكافيين أو المنبهات.",
                // "ابقهم متيقظين وجالسين بشكل مستقيم."

            ];
            const speech = new SpeechSynthesisUtterance(guide.join(" "));

            speech.onend = () => {
                speakBtn.disabled = false;
            };

            window.speechSynthesis.speak(speech);
        }

    </script>


    <!-- Sound effect for button click -->
    <audio id="click-Jazak" src="../sound/Jazak-Allahu khayran kathiran fi ad-dunya wal-akhirah.mp3"
        preload="auto"></audio>
    <!-- <button class="sound-Jazak">Click Me</button> -->
    <script>
        const buttonsJazak = document.querySelectorAll('.sound-Jazak');
        const soundJazak = document.getElementById('click-Jazak');

        buttonsJazak.forEach(button => {
            button.addEventListener('click', () => {
                soundJazak.currentTime = 0;
                soundJazak.play();
            });
        });
    </script>

    <!-- Sound effect for button click -->
    <audio id="click-Voice" src="../sound/ttsMP3.com_help.mp3" preload="auto"></audio>
    <!-- <button class="Voice-Guidance">Click Me</button> -->
    <script>
    const buttons = document.querySelectorAll('.Voice-Guidance');
  const sound = document.getElementById('click-Voice');

  buttons.forEach(button => {
    button.addEventListener('click', () => {
      sound.currentTime = 0;
      sound.play();
    });
  });
</script>

</body>

</html>