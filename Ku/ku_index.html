<!DOCTYPE html>
<html lang="ku" dir="rtl">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>سەرەتا</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" defer></script>
    <script src="../js/script.js" defer></script>
    <style>

    </style>
</head>

<body>
    <!-- Header with Logo -->
    <header>
        <nav>
            <a href="#" class="logo"><img src="../img/logo.PNG" alt="Logo" class="logo" /></a> &nbsp;&nbsp;&nbsp;

            <!-- Hamburger toggle for mobile -->
            <div class="menu-toggle" onclick="toggleMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <ul id="navLinks">
                <li><a href="ku_index.html" class="active">سەرەتا</a></li>
                <li><a href="ku_producat.html">بەرهەمهێنان</a></li>
                <li><a href="ku_about.html">دەربارەی</a></li>
                <li><a href="ku_contact.html">پەیوەندی</a></li>
                <li class="dropdown">
                    <a href="#" class="dropbtn">زمان ▼</a>
                    <div class="dropdown-content">
                        <a href="../index.html">ئینگلیزی</a>
                        <!-- <a href="ar/ar_index.html">عەرەبی</a>
                        <a href="fr/fr_index.html">فەرەنسی</a>
                        <a href="sp/sp_index.html">ئیسپانی</a>
                        <a href="po/po_index.html">پۆڵەندی</a>
                        <a href="it/it_index.html">ئیتاڵی</a>
                        <a href="ch/ch_index.html">چینی</a>
                        <a href="ge/ge_index.html">ئەڵمانی</a> -->
                    </div>
                </li>
            </ul>

        </nav>
    </header>

    <div class="container">
        <h1>پشکنەری فشاری خوێن</h1>
        <p>فشاری خوێنت بپشکنە و دەستبەجێ کاردانەوەی وەربگرن.</p>
        <p>تکایە زانیارییەکانت لە خانەکانی خوارەوە بنووسە:</p>
        <div class="top-group">
            <input type="text" id="fullName" placeholder="Full Name  - ناوی تەواو " />
            <input type="number" id="age" placeholder="Age - تەمەن" min="1" />
            <select id="gender">
                <option value="male">نێر</option>
                <option value="female">مێ</option>
            </select>

        </div>
        <div class="product-list">
            <div class="product-item1">
                <img src="../img/device.png" alt="Product 1">
            </div>
            <div class="product-item2">
                <div class="input-group">
                    <input type="number" id="systolic" placeholder="Systolic" />
                    <input type="number" id="diastolic" placeholder="Diastolic" />
                    <input type="number" id="pulse" placeholder="❤ Pulse" />
                </div>
            </div>
        </div>


        <div id="dateTimeDisplay"> کاتی ئێستا باردەکرێت...</div>

        <button onclick="checkBP()" class="sound-Jazak"> پەستانی خوێن بپشکنە</button>

        <div id="result"></div>

        <!-- Danger buttons hidden by default -->
        <button onclick="showHelp()" id="helpButton" class="danger-btn" style="display:none;">🚨 ئێستا دەبێت چی
            بکەم؟</button>
        <!-- Add this div below the buttons -->
        <div id="helpGuide" style="display:none; 
  margin-top: 15px; 
  max-width: 600px; 
  background: #fff3f3; 
  border: 1px solid #e55353; 
  color: #a94442; 
  padding: 15px; 
  border-radius: 8px; 
  text-align: right;">
            <strong>🚨 ئێستا دەبێت چی بکەم؟</strong>
            <ul>
                <li>ئارام بمێننەوە و یارمەتی کەسەکە بدەن لە دۆزینەوەی شوێنێکی دانیشتنی ئاسوودە.</li>
                <li>هەر جلوبەرگێکی تەسک شل بکە.</li>
                <li>هانی هەناسەی هێواش و قووڵ بدە.</li>
                <li>ئەگەر دەرمانی فشاری خوێنی فریاکەوتن بەکار بهێنیت.</li>
                <li>کافاین و هاندەر مەدە.</li>
                <li>ئاگاداریان بکەرەوە و بە ڕێکوپێکی دابنیشن.</li>
                <li>پەیوەندی بە 911 بکە و لەگەڵیان بمێنەرەوە تا یارمەتی دەگات.</li>
            </ul>
        </div>
        <button onclick="speakGuide()" id="speakButton" class="danger-btn Voice-Guidance" style="display:none;">🔊 ڕێنمایی
            دەنگی</button>

        <button onclick="downloadCSV()" class="sound-Jazak">📥 داگرتن CSV</button>
        <button onclick="window.print()" class="sound-Jazak">🖨️ چاپکردنی ئەنجامەکان</button>

        <div class="history">
            <h3>📜 دوایین 10 پشکنین:</h3>
            <ul id="historyList"></ul>
        </div>

        <div class="description">
            <strong>ڕێنمایی فشاری خوێن:</strong> مەودای ئاسایی بەپێی تەمەن و ڕەگەز دەگۆڕێت. گرنگە بە بەردەوامی پشکنین
            بکەیت و داوای ڕێنمایی پزیشکی بکەیت ئەگەر لە دەرەوەی ئەم مەودایەن.
        </div>

    </div>
    <!-- Footer -->
    <footer>
        <p>دروستکراوە لەلایەن <a href="https://ismael-software.vercel.app/" target="_blank"> نوێژیان </a></p>
        <p>دوایین نوێکردنەوە: حوزەیرانی 2025</p>
        &copy; <a class="border-bottom" href="ku_index.html">پشکنەری فشاری خوێن</a>, هەموو مافەکان پارێزراون.
        دیزاین کراوە لەلایەن <a class="border-bottom" href="https://ismael-software.vercel.app/"> نوێژیان </a>
        </p>
    </footer>

    <script>
        // Update the date/time display every second
        function updateDateTime() {
            const now = new Date();
            const options = {
                year: "numeric",
                month: "short",
                day: "numeric",
                hour: "2-digit",
                minute: "2-digit",
                second: "2-digit",
            };
            document.getElementById("dateTimeDisplay").textContent = " " + now.toLocaleString(undefined, options);
        }
        setInterval(updateDateTime, 1000);
        updateDateTime(); // initial call

        function checkBP() {
            const fullName = document.getElementById('fullName').value.trim();
            const sys = parseInt(document.getElementById('systolic').value);
            const dia = parseInt(document.getElementById('diastolic').value);
            const pulse = parseInt(document.getElementById('pulse').value);
            const gender = document.getElementById('gender').value;
            const age = parseInt(document.getElementById('age').value);

            const result = document.getElementById('result');
            const helpBtn = document.getElementById('helpButton');
            const speakBtn = document.getElementById('speakButton');

            // Validate inputs
            if (!fullName || isNaN(sys) || isNaN(dia) || isNaN(pulse) || isNaN(age)) {
                result.textContent = "تکایە هەموو خانەکان بە دروستی تەواو بکە.";
                result.className = 'danger';
                helpBtn.style.display = 'none';
                speakBtn.style.display = 'none';
                return;
            }

            // Save the record with current time
            const currentTime = new Date().toLocaleString();
            saveHistory({ fullName, sys, dia, pulse, gender, age, time: currentTime });

            // Determine BP status
            let dangerHigh = sys >= 180 || dia >= 120;
            let dangerLow = sys < 80 || dia < 50;
            let normal = (sys >= 90 && sys <= 130) && (dia >= 60 && dia <= 85);

            if (dangerHigh) {
                result.textContent = "❗ بە شێوەیەکی مەترسیدار! دەستبەجێ پەیوەندی بە 911 بکە!";
                result.className = 'danger';
                helpBtn.style.display = 'inline-block';
                speakBtn.style.display = 'inline-block';
            } else if (dangerLow) {
                result.textContent = "❗ بەشێوەیەکی مەترسیدار! تکایە بەدوای چاودێری پزیشکیدا بگەڕێن.";
                result.className = 'danger';
                helpBtn.style.display = 'inline-block';
                speakBtn.style.display = 'inline-block';
            } else if (!normal) {
                result.textContent = "⚠️ پەستانی خوێن کەمێک لە ئاستی ئاسایی دوورە";
                result.className = 'danger';
                helpBtn.style.display = 'none';
                speakBtn.style.display = 'none';
            } else {
                result.textContent = "✅ پەستانی خوێن لە مەودای ئاساییدایە.";
                result.className = 'normal';
                helpBtn.style.display = 'none';
                speakBtn.style.display = 'none';
            }
        }

        // Save to localStorage and keep only last 10
        function saveHistory(entry) {
            let history = JSON.parse(localStorage.getItem("bpHistory")) || [];
            history.unshift(entry);
            history = history.slice(0, 10);
            localStorage.setItem("bpHistory", JSON.stringify(history));
            displayHistory();
        }

        // Display history list
        function displayHistory() {
            const history = JSON.parse(localStorage.getItem("bpHistory")) || [];
            const list = document.getElementById("historyList");
            list.innerHTML = '';
            history.forEach((entry, i) => {
                const li = document.createElement("li");
                li.textContent = `${i + 1}. ${entry.fullName} → Sys: ${entry.sys}, Dia: ${entry.dia}, Pulse: ${entry.pulse} @ ${entry.time}`;
                list.appendChild(li);
            });
        }

        // Download history as CSV file
        function downloadCSV() {
            const history = JSON.parse(localStorage.getItem("bpHistory")) || [];
            if (history.length === 0) return alert("No data to download.");
            const header = ["Full Name", "Systolic", "Diastolic", "Pulse", "Gender", "Age", "Time"];
            const rows = history.map(e => [e.fullName, e.sys, e.dia, e.pulse, e.gender, e.age, e.time]);
            const csv = [header, ...rows].map(row => row.join(",")).join("\n");
            const blob = new Blob([csv], { type: "text/csv" });
            const a = document.createElement("a");
            a.href = URL.createObjectURL(blob);
            a.download = "bp_readings.csv";
            a.click();
        }

        // Alert with medical help instructions
        function showHelp() {
            const guideDiv = document.getElementById("helpGuide");
            // Toggle visibility
            if (guideDiv.style.display === "none") {
                guideDiv.style.display = "block";
            } else {
                guideDiv.style.display = "none";
            }
        }

        // Voice guidance with speech synthesis
        function speakGuide() {
            const speakBtn = document.getElementById("speakButton");
            if (window.speechSynthesis.speaking) {
                window.speechSynthesis.cancel();
                speakBtn.disabled = false;
                return;
            }
            speakBtn.disabled = true;

            const guide = [
                // "ئارام بمێننەوە و یارمەتی کەسەکە بدەن لە دۆزینەوەی شوێنێکی دانیشتنی ئاسوودە.",
                // "هەر جلوبەرگێکی تەسک شل بکە.",
                // "هانی هەناسەی هێواش و قووڵ بدە.",
                // "ئەگەر دەرمانی فشاری خوێنی فریاکەوتن بەکار بهێنیت.",
                // "کافاین و هاندەر مەدە.",
                // "ئاگاداریان بکەرەوە و بە ڕێکوپێکی دابنیشن.",
                // "پەیوەندی بە 911 بکە و لەگەڵیان بمێنەرەوە تا یارمەتی دەگات."
            ];
            const speech = new SpeechSynthesisUtterance(guide.join(" "));

            speech.onend = () => {
                speakBtn.disabled = false;
            };

            window.speechSynthesis.speak(speech);
        }

    </script>


    <!-- Sound effect for button click -->
    <audio id="click-Jazak" src="../sound/Jazak-Allahu khayran kathiran fi ad-dunya wal-akhirah.mp3"
        preload="auto"></audio>
    <!-- <button class="sound-Jazak">Click Me</button> -->
    <script>
        const buttonsJazak = document.querySelectorAll('.sound-Jazak');
        const soundJazak = document.getElementById('click-Jazak');

        buttonsJazak.forEach(button => {
            button.addEventListener('click', () => {
                soundJazak.currentTime = 0;
                soundJazak.play();
            });
        });
    </script>

    <!-- Sound effect for button click -->
    <audio id="click-Voice" src="../sound/ttsMP3.com_help.mp3" preload="auto"></audio>
    <!-- <button class="Voice-Guidance">Click Me</button> -->
    <script>
    const buttons = document.querySelectorAll('.Voice-Guidance');
  const sound = document.getElementById('click-Voice');

  buttons.forEach(button => {
    button.addEventListener('click', () => {
      sound.currentTime = 0;
      sound.play();
    });
  });
</script>

    <!-- 
ئارام بە و یارمەتی تاک بدە لە دۆزینەوەی شوێنێکی دانیشتنی ئاسوودە هەر جلوبەرگێکی تەسک شل بکەوە. هاندانی هەناسەدانی هێواش و قووڵ. ئەگەر دەرسیان بۆ نووسراوە، دەرمانی فشاری خوێنی خێرا بەکار بهێنن. خۆت لە پێدانی کافاین و هاندەر بەدوور بگرە. دڵنیا بەوە لەوەی کە بەخەبەر دەمێننەوە و بە شێوەیەکی ڕاست دەمێننەوە. پەیوەندی بە 911 بکە و لەگەڵیان بمێنەرەوە تاوەکو یارمەتی دێت.
-->
    <!--
Stay calm and help the person sit comfortably.
Loosen any tight clothing.
Encourage slow, deep breaths.
If prescribed, give emergency blood pressure medication.
Do not give caffeine or stimulants.
Keep them alert and seated upright.
Call 911 and stay with them until help arrives. 
 -->


</body>

</html>